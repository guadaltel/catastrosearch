!function(e){function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}var t={};__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},__webpack_require__.n=function(e){var t=e&&e.e?function(){return e.default}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=1)}([function(e,t,n){"use strict";var r=function(e){return function(t){var n=e.split("."),r=n[0];window[r]||(window[r]={}),function constructObject(e,n){if(e.length>0){var r=e[0];n[r]||(n[r]={}),constructObject(e.splice(1),n[r])}else n[t.name]=t;return n}(n.splice(1),window[r])}};e.exports=r},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.e?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r,a,i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),o=n(0),l=_interopRequireDefault(o),c=n(2),s=(_interopRequireDefault(c),n(4));_interopRequireDefault(s),(r=(0,l.default)("M.plugin"))(a=function(e){function CatastroSearch(e){_classCallCheck(this,CatastroSearch),e=e||{};var t=_possibleConstructorReturn(this,(CatastroSearch.__proto__||Object.getPrototypeOf(CatastroSearch)).call(this,e));return t.t=null,t.r=null,t.a=null,t.u={},M.utils.isNullOrEmpty(e.params)||(t.u=e.params),t.h={},M.utils.isNullOrEmpty(e.options)||(t.h=e.options),t}return _inherits(CatastroSearch,e),i(CatastroSearch,[{key:"addTo",value:function(e){var t=this;this.t=e,this.r=new M.control.CatastroSearchControl,this.a=new M.ui.Panel("catastrosearch",{collapsible:!0,className:"m-catastrosearch",collapsedButtonClass:"g-cartografia-localizacion3",position:M.ui.position.TR,tooltip:"Búsqueda catastral"}),this.a.on(M.evt._,function(e){M.utils.enableTouchScroll(e)}),this.a.addControls(this.r),this.t.addPanels(this.a),this.r.on(M.evt._,function(){t.fire(M.evt._)})}},{key:"destroy",value:function(){this.t.removeControls([this.r]),this.t=null,this.r=null,this.a=null,this.h=null}},{key:"equals",value:function(e){return e instanceof CatastroSearch}}]),CatastroSearch}(M.Plugin))},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.e?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CatastroSearchControl=void 0;var r,a,i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),o=n(0),l=_interopRequireDefault(o),c=n(3);_interopRequireDefault(c),t.CatastroSearchControl=(r=(0,l.default)("M.control"))(a=function(e){function CatastroSearchControl(){_classCallCheck(this,CatastroSearchControl),M.utils.isUndefined(M.impl.control.CatastroSearchControl)&&M.exception("La implementación usada no puede crear controles CatastroSearchControl");var e=new M.impl.control.CatastroSearchControl,t=_possibleConstructorReturn(this,(CatastroSearchControl.__proto__||Object.getPrototypeOf(CatastroSearchControl)).call(this,e,"CatastroSearch"));return t.f=null,t.v="",t.y=null,t.b=null,t.C=null,t.g=null,t.M=null,t.P=["ALMERIA","CADIZ","CORDOBA","GRANADA","HUELVA","JAEN","MALAGA","SEVILLA"],t}return _inherits(CatastroSearchControl,e),i(CatastroSearchControl,[{key:"addEvents",value:function(e){var t=this;this.O=e.querySelector(".button > button.load"),this.w=e.querySelector(".button > button.clear"),this.g=e.querySelector(".form div.province > select"),this.C=e.querySelector(".form div.municipality > select"),this.y=e.querySelector(".form div.parcel > input"),this.b=e.querySelector(".form div.polygon > input"),this.M=e.querySelector(".form div.reference > input"),this.f=e.querySelectorAll('input[name="tabs-catastro"]'),this.v=e.querySelector('input[name="tabs-catastro"]:checked').dataset.tab,this.w.addEventListener("click",function(e){return t.clearInputs()}),this.O.addEventListener("click",function(e){return t.getRC()}),this.g.addEventListener("change",function(e){return t.changeProvince(e)}),this.C.addEventListener("change",function(e){return t.changeMunicipality(e)}),this.y.addEventListener("input",function(e){return t.checkButtons(e)}),this.b.addEventListener("input",function(e){return t.checkButtons(e)}),this.M.addEventListener("input",function(e){return t.checkButtons(e)}),this.f.forEach(function(e){e.addEventListener("change",function(e){return t.changeTab(e)})})}},{key:"getRC",value:function(){"referencia"==this.v?(this.S=this.M.value,this.S.length>14&&(this.S=this.S.slice(0,14)),this.getCoordinatesRC()):this.getRCFromPP()}},{key:"changeTab",value:function(e){e=e||window.event;var t=e.target;this.v=t.dataset.tab,this.checkButtons()}},{key:"createView",value:function(e){var t=this;return new Promise(function(e,n){M.template.compile("catastrosearch.html",{vars:{provincias:t.P}}).then(function(n){t.addEvents(n),e(n)})})}},{key:"checkButtons",value:function(){"referencia"==this.v?(this.w.disabled=M.utils.isNullOrEmpty(this.M.value),this.O.disabled=M.utils.isNullOrEmpty(this.M.value)):(this.w.disabled=M.utils.isNullOrEmpty(this.g.value)&&M.utils.isNullOrEmpty(this.C.value)&&M.utils.isNullOrEmpty(this.b.value)&&M.utils.isNullOrEmpty(this.y.value),this.O.disabled=M.utils.isNullOrEmpty(this.g.value)||M.utils.isNullOrEmpty(this.C.value)||M.utils.isNullOrEmpty(this.b.value)||M.utils.isNullOrEmpty(this.y.value))}},{key:"clearInputs",value:function(){"referencia"==this.v?this.M.value="":(this.b.value="",this.y.value="",this.g.value="",this.C.value=""),this.checkButtons(),this.getImpl().clearCoordinatesLayer()}},{key:"changeProvince",value:function(e){this.checkButtons(),this.getMunicipios()}},{key:"changeMunicipality",value:function(e){this.checkButtons()}},{key:"getMunicipios",value:function(){var e=this;"referencia"==this.v&&(this.S=this.M.value);M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejero.asmx/ConsultaMunicipio",{Provincia:this.g.value,Municipio:""},{jsonp:!0}).then(function(t){var n=new DOMParser,r=n.parseFromString(t.text,"text/xml"),a=r.getElementsByTagName("error");if(e.C.innerHTML=null,e.createMunicipalityOption("Municipio...",""),a.length)M.dialog.error("Error al consultar al catastro: "+a[0].childNodes[0].nodeValue);else for(var i=r.getElementsByTagName("nm"),o=0;o<i.length;o++){var l=i[o].childNodes[0].nodeValue;e.createMunicipalityOption(l,l)}})}},{key:"createMunicipalityOption",value:function(e,t){var n=document.createElement("option");n.value=t,n.innerHTML=e,this.C.appendChild(n)}},{key:"getCoordinatesRC",value:function(){var e=this;M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCoordenadas.asmx/Consulta_CPMRC",{Provincia:"",Municipio:"",SRS:"EPSG:4326",RC:this.S},{jsonp:!0}).then(function(t){var n=new DOMParser,r=n.parseFromString(t.text,"text/xml"),a=r.getElementsByTagName("des");if(a.length)M.dialog.error(a[0].childNodes[0].nodeValue);else{var i=parseFloat(r.getElementsByTagName("xcen")[0].childNodes[0].nodeValue),o=parseFloat(r.getElementsByTagName("ycen")[0].childNodes[0].nodeValue);e.getImpl().clearCoordinatesLayer(),e.getImpl().addCoordToMap(i,o,"EPSG:4326"),e.getImpl().centerLayer()}})}},{key:"getRCFromPP",value:function(){var e=this;M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejero.asmx/Consulta_DNPPP",{Provincia:this.g.value,Municipio:this.C.value,Poligono:this.b.value,Parcela:this.y.value},{jsonp:!0}).then(function(t){var n=new DOMParser,r=n.parseFromString(t.text,"text/xml"),a=r.getElementsByTagName("des");if(a.length)M.dialog.info(a[0].childNodes[0].nodeValue);else{var i=r.getElementsByTagName("pc1"),o=r.getElementsByTagName("pc2");e.S=i[0].childNodes[0].nodeValue+o[0].childNodes[0].nodeValue,e.getCoordinatesRC()}})}}]),CatastroSearchControl}(M.Control))||a},function(e,t,n){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CatastroSearchControl=void 0;var r,a,i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),o=n(0),l=function(e){return e&&e.e?e:{default:e}}(o);t.CatastroSearchControl=(r=(0,l.default)("M.impl.control"))(a=function(e){function CatastroSearchControl(){_classCallCheck(this,CatastroSearchControl);var e=_possibleConstructorReturn(this,(CatastroSearchControl.__proto__||Object.getPrototypeOf(CatastroSearchControl)).call(this));return e.k=new M.layer.Vector({name:"Catastro_Coordinates"},{displayInLayerSwitcher:!1}),e}return _inherits(CatastroSearchControl,e),i(CatastroSearchControl,[{key:"addTo",value:function(e,t){this.R=e,this.element=t,e.addLayers(this.k);var n=e.getMapImpl();ol.control.Control.call(this,{element:t,target:null}),n.addControl(this)}},{key:"activate",value:function(){}},{key:"deactivate",value:function(){}},{key:"addCoordToMap",value:function(e,t,n){var r=ol.proj.transform([e,t],n,this.R.getProjection().code),a=new M.Feature(null,{geometry:{coordinates:r,type:"Point"}});return this.k.addFeatures(a),this.k}},{key:"centerLayer",value:function(){var e=this.k.getFeaturesExtent();M.utils.isNullOrEmpty(e)||this.R.getMapImpl().getView().fit(e,{duration:500,minResolution:1})}},{key:"clearCoordinatesLayer",value:function(){this.k.clear()}}]),CatastroSearchControl}(M.impl.Control))||a},function(e,t){}]),M.template.add("catastrosearch.html",Handlebars.template({1:function(e,t,n,r,a){var i=e.lambda,o=e.escapeExpression;return'                <option value="'+o(i(t,t))+'">'+o(i(t,t))+"</option>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,a){var i;return'<div class="m-control m-catastrosearch-container">\n    \x3c!-- TITLE --\x3e\n    <div class="title">Búsqueda catastral</div>\n\n    <input id="tab1" class="tabs" data-tab="referencia" type="radio" name="tabs-catastro" checked>\n    <label for="tab1">Referencia</label>\n\n    <input id="tab2" class="tabs" data-tab="pol_par" type="radio" name="tabs-catastro">\n    <label for="tab2">Polígono/Parcela</label>\n    <div class="tabs-border"></div>\n    \x3c!-- FORM --\x3e\n    <div id="content1" class="form catastro">\n        \x3c!-- Referencia Catastral --\x3e\n        <div class="reference">\n            <label>Referencia Catastral</label>\n            <input type="text" maxlength="20">\n        </div>\n    </div>\n    \x3c!-- FORM --\x3e\n    <div id="content2" class="form catastro">\n        \x3c!-- Provincia --\x3e\n        <div class="province">\n            <label>Provincia</label>\n            <select name="provincelist">\n                <option value="">Provincia...</option>\n'+(null!=(i=n.each.call(null!=t?t:e.nullContext||{},null!=t?t.provincias:t,{name:"each",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a}))?i:"")+'            </select>\n        </div>\n        \x3c!-- Municipio --\x3e\n        <div class="municipality">\n            <label>Municipio</label>\n            <select name="municipalitylist">\n                <option value="">Municipio...</option>\n            </select>\n        </div>\n        \x3c!-- Poligono --\x3e\n        <div class="polygon">\n            <label>Polígono</label>\n            <input type="number">\n        </div>\n        \x3c!-- Parcela --\x3e\n        <div class="parcel">\n            <label>Parcela</label>\n            <input type="number">\n        </div>\n    </div>\n    \x3c!-- buttons --\x3e\n    <div class="button">\n        <button class="load" title="Buscar coordenada" disabled>\n            <i class="g-cartografia-posicion3"></i> Buscar</button>\n        <button class="clear" title="Limpiar coordenadas" disabled>\n            <i class="g-cartografia-check4"></i> Limpiar</button>\n    </div>\n</div>'},useData:!0}));