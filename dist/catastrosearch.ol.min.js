!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports='<div class="m-control m-catastrosearch-container">\n    \x3c!-- TITLE --\x3e\n    <div class="title">Búsqueda catastral</div>\n\n    <input id="tab1" class="tabs" data-tab="referencia" type="radio" name="tabs-catastro" checked>\n    <label for="tab1">Referencia</label>\n\n    <input id="tab2" class="tabs" data-tab="pol_par" type="radio" name="tabs-catastro">\n    <label for="tab2">Polígono/Parcela</label>\n    <div class="tabs-border"></div>\n    \x3c!-- FORM --\x3e\n    <div id="content1" class="form catastro">\n        \x3c!-- Referencia Catastral --\x3e\n        <div class="reference">\n            <label>Referencia Catastral</label>\n            <input type="text" maxlength="20">\n        </div>\n    </div>\n    \x3c!-- FORM --\x3e\n    <div id="content2" class="form catastro">\n        \x3c!-- Provincia --\x3e\n        <div class="province">\n            <label>Provincia</label>\n            <select name="provincelist">\n                <option value="">Provincia...</option>\n                {{#each provincias}}\n                <option value="{{this}}">{{this}}</option>\n                {{/each}}\n            </select>\n        </div>\n        \x3c!-- Municipio --\x3e\n        <div class="municipality">\n            <label>Municipio</label>\n            <select name="municipalitylist">\n                <option value="">Municipio...</option>\n            </select>\n        </div>\n        \x3c!-- Poligono --\x3e\n        <div class="polygon">\n            <label>Polígono</label>\n            <input type="number">\n        </div>\n        \x3c!-- Parcela --\x3e\n        <div class="parcel">\n            <label>Parcela</label>\n            <input type="number">\n        </div>\n    </div>\n    \x3c!-- buttons --\x3e\n    <div class="button">\n        <button class="load" title="Buscar coordenada" disabled>\n            <i class="g-cartografia-posicion3"></i> Buscar</button>\n        <button class="clear" title="Limpiar coordenadas" disabled>\n            <i class="g-cartografia-check4"></i> Limpiar</button>\n    </div>\n</div>'},function(t,e,n){},function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=c(t);if(e){var r=c(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return l(this,n)}}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.r(e);var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(c,M.impl.Control);var e,n,o,l=a(c);function c(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(t=l.call(this)).layer_=new M.layer.Vector({name:"Catastro_Coordinates"},{displayInLayerSwitcher:!1}),t}return e=c,(n=[{key:"addTo",value:function(t,e){this.facadeMap_=t,this.element=e,t.addLayers(this.layer_);var n=t.getMapImpl();ol.control.Control.call(this,{element:e,target:null}),n.addControl(this)}},{key:"activate",value:function(){}},{key:"deactivate",value:function(){}},{key:"addCoordToMap",value:function(t,e,n){var o=ol.proj.transform([t,e],n,this.facadeMap_.getProjection().code),r=new M.Feature(null,{geometry:{coordinates:o,type:"Point"}});return this.layer_.addFeatures(r),this.layer_}},{key:"centerLayer",value:function(){var t=this.layer_.getFeaturesExtent();M.utils.isNullOrEmpty(t)||this.facadeMap_.getMapImpl().getView().fit(t,{duration:500,minResolution:1})}},{key:"clearCoordinatesLayer",value:function(){this.layer_.clear()}}])&&r(e.prototype,n),o&&r(e,o),c}(),s=n(0),p=n.n(s);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=m(t);if(e){var r=m(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return v(this,n)}}function v(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(i,M.Control);var e,n,o,r=h(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),M.utils.isUndefined(u)&&M.exception("La implementación usada no puede crear controles CatastroSearchControl");var e=new u;return(t=r.call(this,e,"CatastroSearch")).inputsTabs_=null,t.selectedTab_="",t.inputParcel_=null,t.inputPolygon_=null,t.selectMunicipality_=null,t.selectProvince_=null,t.inputReference_=null,t.provincias_=["ALMERIA","CADIZ","CORDOBA","GRANADA","HUELVA","JAEN","MALAGA","SEVILLA"],t}return e=i,(n=[{key:"addEvents",value:function(t){var e=this;this.loadBtn_=t.querySelector(".button > button.load"),this.clearBtn_=t.querySelector(".button > button.clear"),this.selectProvince_=t.querySelector(".form div.province > select"),this.selectMunicipality_=t.querySelector(".form div.municipality > select"),this.inputParcel_=t.querySelector(".form div.parcel > input"),this.inputPolygon_=t.querySelector(".form div.polygon > input"),this.inputReference_=t.querySelector(".form div.reference > input"),this.inputsTabs_=t.querySelectorAll('input[name="tabs-catastro"]'),this.selectedTab_=t.querySelector('input[name="tabs-catastro"]:checked').dataset.tab,this.clearBtn_.addEventListener("click",(function(t){return e.clearInputs()})),this.loadBtn_.addEventListener("click",(function(t){return e.getRC()})),this.selectProvince_.addEventListener("change",(function(t){return e.changeProvince(t)})),this.selectMunicipality_.addEventListener("change",(function(t){return e.changeMunicipality(t)})),this.inputParcel_.addEventListener("input",(function(t){return e.checkButtons(t)})),this.inputPolygon_.addEventListener("input",(function(t){return e.checkButtons(t)})),this.inputReference_.addEventListener("input",(function(t){return e.checkButtons(t)})),this.inputsTabs_.forEach((function(t){t.addEventListener("change",(function(t){return e.changeTab(t)}))}))}},{key:"getRC",value:function(){"referencia"==this.selectedTab_?(this.rc_=this.inputReference_.value,this.rc_.length>14&&(this.rc_=this.rc_.slice(0,14)),this.getCoordinatesRC()):this.getRCFromPP()}},{key:"changeTab",value:function(t){var e=(t=t||window.event).target;this.selectedTab_=e.dataset.tab,this.checkButtons()}},{key:"createView",value:function(t){var e=this;return M.template.compileSync||(M.template.compileSync=function(t,e){var n,o={};M.utils.isUndefined(e)||(o=M.utils.extends(o,e.vars),n=e.parseToHtml);var r=Handlebars.compile(t)(o);return!1!==n?M.utils.stringToHtml(r):r}),new Promise((function(t,n){var o=M.template.compileSync(p.a,{vars:{provincias:e.provincias_}});e.addEvents(o),t(o)}))}},{key:"checkButtons",value:function(){"referencia"==this.selectedTab_?(this.clearBtn_.disabled=M.utils.isNullOrEmpty(this.inputReference_.value),this.loadBtn_.disabled=M.utils.isNullOrEmpty(this.inputReference_.value)):(this.clearBtn_.disabled=M.utils.isNullOrEmpty(this.selectProvince_.value)&&M.utils.isNullOrEmpty(this.selectMunicipality_.value)&&M.utils.isNullOrEmpty(this.inputPolygon_.value)&&M.utils.isNullOrEmpty(this.inputParcel_.value),this.loadBtn_.disabled=M.utils.isNullOrEmpty(this.selectProvince_.value)||M.utils.isNullOrEmpty(this.selectMunicipality_.value)||M.utils.isNullOrEmpty(this.inputPolygon_.value)||M.utils.isNullOrEmpty(this.inputParcel_.value))}},{key:"clearInputs",value:function(){"referencia"==this.selectedTab_?this.inputReference_.value="":(this.inputPolygon_.value="",this.inputParcel_.value="",this.selectProvince_.value="",this.selectMunicipality_.value=""),this.checkButtons(),this.getImpl().clearCoordinatesLayer()}},{key:"changeProvince",value:function(t){this.checkButtons(),this.getMunicipios()}},{key:"changeMunicipality",value:function(t){this.checkButtons()}},{key:"getMunicipios",value:function(){var t=this;"referencia"==this.selectedTab_&&(this.rc_=this.inputReference_.value),M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejero.asmx/ConsultaMunicipio",{Provincia:this.selectProvince_.value,Municipio:""},{jsonp:!0}).then((function(e){var n=(new DOMParser).parseFromString(e.text,"text/xml"),o=n.getElementsByTagName("error");if(t.selectMunicipality_.innerHTML=null,t.createMunicipalityOption("Municipio...",""),o.length)M.dialog.error("Error al consultar al catastro: "+o[0].childNodes[0].nodeValue);else for(var r=n.getElementsByTagName("nm"),i=0;i<r.length;i++){var a=r[i].childNodes[0].nodeValue;t.createMunicipalityOption(a,a)}}))}},{key:"createMunicipalityOption",value:function(t,e){var n=document.createElement("option");n.value=e,n.innerHTML=t,this.selectMunicipality_.appendChild(n)}},{key:"getCoordinatesRC",value:function(){var t=this;M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCoordenadas.asmx/Consulta_CPMRC",{Provincia:"",Municipio:"",SRS:"EPSG:4326",RC:this.rc_},{jsonp:!0}).then((function(e){var n=(new DOMParser).parseFromString(e.text,"text/xml"),o=n.getElementsByTagName("des");if(o.length)M.dialog.error(o[0].childNodes[0].nodeValue);else{var r=parseFloat(n.getElementsByTagName("xcen")[0].childNodes[0].nodeValue),i=parseFloat(n.getElementsByTagName("ycen")[0].childNodes[0].nodeValue);t.getImpl().clearCoordinatesLayer(),t.getImpl().addCoordToMap(r,i,"EPSG:4326"),t.getImpl().centerLayer()}}))}},{key:"getRCFromPP",value:function(){var t=this;M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejero.asmx/Consulta_DNPPP",{Provincia:this.selectProvince_.value,Municipio:this.selectMunicipality_.value,Poligono:this.inputPolygon_.value,Parcela:this.inputParcel_.value},{jsonp:!0}).then((function(e){var n=(new DOMParser).parseFromString(e.text,"text/xml"),o=n.getElementsByTagName("des");if(o.length)M.dialog.info(o[0].childNodes[0].nodeValue);else{var r=n.getElementsByTagName("pc1"),i=n.getElementsByTagName("pc2");t.rc_=r[0].childNodes[0].nodeValue+i[0].childNodes[0].nodeValue,t.getCoordinatesRC()}}))}}])&&d(e.prototype,n),o&&d(e,o),i}();n(1);function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=C(t);if(e){var r=C(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return w(this,n)}}function w(t,e){return!e||"object"!==_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(i,M.Plugin);var e,n,o,r=O(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),t=t||{},(e=r.call(this,t)).map_=null,e.control_=null,e.panel_=null,e.params_={},M.utils.isNullOrEmpty(t.params)||(e.params_=t.params),e.options_={},M.utils.isNullOrEmpty(t.options)||(e.options_=t.options),e}return e=i,(n=[{key:"addTo",value:function(t){var e=this;this.map_=t,this.control_=new b,this.panel_=new M.ui.Panel("catastrosearch",{collapsible:!0,className:"m-catastrosearch",collapsedButtonClass:"g-cartografia-localizacion3",position:M.ui.position.TR,tooltip:"Búsqueda catastral"}),this.panel_.on(M.evt.ADDED_TO_MAP,(function(t){M.utils.enableTouchScroll(t)})),this.panel_.addControls(this.control_),this.map_.addPanels(this.panel_),this.control_.on(M.evt.ADDED_TO_MAP,(function(){e.fire(M.evt.ADDED_TO_MAP)}))}},{key:"destroy",value:function(){this.map_.removeControls([this.control_]),this.map_=null,this.control_=null,this.panel_=null,this.options_=null}},{key:"equals",value:function(t){return t instanceof i}}])&&g(e.prototype,n),o&&g(e,o),i}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.CatastroSearch=S,window.M.control.CatastroSearchControl=b,window.M.impl.control.CatastroSearchControl=u}]);
//# sourceMappingURL=catastrosearch.ol.min.js.map